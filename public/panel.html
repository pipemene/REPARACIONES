<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Panel - BlueHome OS</title>
  <style>
    body{margin:0;font-family:Arial;background:#f9fafb}
    .topbar{background:#0f172a;color:#fff;padding:10px;display:flex;align-items:center;justify-content:space-between}
    .welcome{font-size:14px}
    .logo{text-align:center;font-weight:bold;font-size:20px;flex:1}
    .logout{cursor:pointer;color:#fff;background:#dc2626;border:none;padding:6px 12px;border-radius:6px}
  </style>
</head>
<body>
  <div class="topbar">
    <div id="welcome" class="welcome"></div>
    <div class="logo">BlueHome Inmobiliaria</div>
    <button class="logout" onclick="logout()">Cerrar sesión</button>
  </div>
  <div style="padding:20px">
    <p>Panel principal (contenido según rol irá aquí)</p>
  </div>
<script>
async function loadUser(){
  const token = localStorage.getItem('token');
  if(!token){ window.location.href='/'; return; }
  const res = await fetch('/api/user',{headers:{'Authorization':'Bearer '+token}});
  if(res.ok){
    const data = await res.json();
    document.getElementById('welcome').innerText = `Bienvenido, ${data.username} (${data.role})`;
  }else{
    window.location.href='/';
  }
}
function logout(){
  localStorage.removeItem('token');
  window.location.href='/';
}
loadUser();
</script>
</body>
</html>